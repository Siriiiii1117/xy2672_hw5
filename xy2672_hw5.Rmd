---
title: "xy2672_hw5"
output: html_document
date: "2025-11-14"
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1 

Function of drawing `birthdays` out and return if there are duplicate `birthdays`

```{r}
repeat_birthday = function(n){
  birthdays = sample(1:365, n, replace = TRUE)
  
  repeated = length(unique(birthdays)) < n
  
  repeated
}
```

Run the function 10000 times for each group size between 2 and 50, then compute the probability that at least two people in the group will share a birthday

```{r}
sim_results_df = 
  expand_grid(
    n = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    results = map_lgl(n, repeat_birthday),
  ) |> 
  group_by(
    n
  ) |> 
  summarize(
    prob_same_bday = mean(results)
  ) 
```

Making a plot:

```{r}
sim_results_df |> 
  ggplot(aes(x = n, y = prob_same_bday)) + 
  geom_point() + 
  geom_line()
```

From the plot, we can see that as the number of people increases, the probability of having duplicate birthdays increases. The probability increases more rapidly from size 20 to 30, and reaches 0.5 when the sample size is 23. 


## HW2

Creating a function to generate the mu_hat and p-value:

```{r}
rnorm_sim = function(mu){
  sample = rnorm(30, mean = mu, sd = 5)
  
  test_results = 
    t.test(sample, mu = 0) |> 
    broom::tidy() |> 
    select(estimate, p.value)
  
  test_results
}
```

Run the function for mu from 0 to 6 for 5000 times and record the results:

```{r}
rnorm_sim_results_df = 
  expand_grid(
    mu = 0:6,
    iter = 1:5000
  ) |> 
  mutate(
    results = map(mu, rnorm_sim)
  ) |> 
  unnest(results)
```

calculate power and create `power_df` for plotting:

```{r}
power_df = 
  rnorm_sim_results_df |> 
  group_by(
    mu
  ) |> 
  summarize(
    power = mean(p.value < 0.05)
  )
```



